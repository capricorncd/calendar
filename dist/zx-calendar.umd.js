(function(h,A){typeof exports=="object"&&typeof module<"u"?A(exports):typeof define=="function"&&define.amd?define(["exports"],A):(h=typeof globalThis<"u"?globalThis:h||self,A(h.zxCalendar={}))})(this,function(h){"use strict";const A="yyyy/MM",dt="yyyy-yyyy",ht="yyyy",_="is-selected",V="is-disabled",ft="is-holiday",pt="is-current",G="is-range-first",U="is-range-last",z="is-range-first-last",J="is-range-temp",K="is-first-page",X="is-last-page",yt="is-weekend",C="date-only",O="__prev-button",w="__next-button",x="__title-wrapper",q="__item-week",Z="__confirm-button",Q="__clear-button",tt="__cancel-button",et="multiple",m="range",_t="single",$="date",v="month",L="year",st={en:{full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},jp:{full:["\u65E5\u66DC\u65E5","\u6708\u66DC\u65E5","\u706B\u66DC\u65E5","\u6C34\u66DC\u65E5","\u6728\u66DC\u65E5","\u91D1\u66DC\u65E5","\u571F\u66DC\u65E5"],abbr:["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"]},zh:{full:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],abbr:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"]}},gt=["confirmButton","cancelButton","clearButton"],nt={en:["ok","cancel","clear"],jp:["\u9078\u629E","\u30AD\u30E3\u30F3\u30BB\u30EB","\u30AF\u30EA\u30A2\u30FC"],zh:["\u786E\u5B9A","\u53D6\u6D88","\u6E05\u9664"]};function Et(e="en",t){const s=nt[e]||nt.en,n=gt.reduce((a,o,r)=>(a[o]=s[r],a),{}),i=st[e]||st.en;return n.weeks=t?i.full:i.abbr,n}function mt({lang:e,isFullWeek:t,langPackage:s}){return{langPackage:{...Et(e,t),...s}}}/*!
 * date-utils-2020 v1.1.0
 * Author: Capricorncd
 * Repository: https://github.com/capricorncd/date-utils-2020#readme
 * Released on: 2023/01/14 14:10:19 GMT+0900
 */function N(e){return String(e).padStart(2,"0")}const St={weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function y(e,t,s){const n=D(e);if(!n||!t)return String(e);if(t==="timestamp")return n.getTime().toString();if(/(y+)/i.test(t)){const o=RegExp.$1;t=t.replace(o,(n.getFullYear()+"").substring(4-o.length))}(!s||!Array.isArray(s.weeks))&&(s=St);const i={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"a+":n.getHours()<12?"am":"pm","A+":n.getHours()<12?"AM":"PM"};let a;for(const o in i)if(new RegExp("("+o+")").test(t)){a=RegExp.$1;const r=i[o]+"";t=t.replace(a,a.length===1?r:N(r))}if(/w+/i.test(t)){const o=n.getDay();t=t.replace(/w+/i,/W+/.test(t)?s.weeks[o]:String(o))}if(/g/i.test(t)){const o=n.toString().split(/\s+/).slice(5),r=t.includes("g");t=t.replace(/g/i,r?o[0]:o.join(" "))}return t}function D(e){let t=null;if(e instanceof Date)t=e;else if(typeof e=="number")t=new Date(e);else if(typeof e=="string"){let s=e.trim();if(/^\d+$/.test(s)){const n=s.length;n===8?t=new Date([s.substring(0,4),s.substring(4,6),s.substring(6,8)].join("/")):n===6?t=new Date([s.substring(0,4),s.substring(4,6),"01"].join("/")):n===4?t=new Date(s+"/01/01"):t=new Date(parseInt(e))}else s=s.replace(/[年月日]/g,n=>n==="\u65E5"?"":"/").replace(/[(（（].*?[)））]/g," ").replace(/\bam|pm\b/ig," ").replace(/\s+/g," "),/^(\d{4})[-/](\d{1,2})[-/](\d{1,2})$/.test(s)?t=new Date([RegExp.$1,RegExp.$2,RegExp.$3].join("/")):/^(\d{4})[-/](\d{1,2})$/.test(s)?t=new Date([RegExp.$1,RegExp.$2,"01"].join("/")):t=new Date(s)}return t&&!isNaN(t.getFullYear())?t:null}const Tt={date:"yyyyMMdd",month:"yyyyMM",year:"yyyy"};function p(e){return e>>0}function R(e){return typeof e=="string"}function it(e){return typeof e=="function"}function Mt({current:e,currentDate:t}){const s=e.slice(0,2);s.push("01");const n=new Date(s.join("/")).getDay();let i=t.getFullYear(),a=t.getMonth()+1;a===12?(i+=1,a=1):a+=1;const o=new Date(`${i}/${N(a)}/01`).getTime(),r=new Date(o-1);return{firstDayOfWeek:n,lastDayOfMonth:r.getDate()}}function At(e){const t=p(e.substr(2)),s=t%20===0,n=Math.floor(t/20);let i=(s?n-1:n)*20+1,a=p(e.substr(0,2));n===0&&t===0&&(a-=1,i=81);const o=a*100+i,r=o+19;return{startFullYear:o,endFullYear:r}}function g(e,t){const s=[];if(Array.isArray(e)){const[n,i]=e;let a=D(n),o=D(i);R(t)&&(a=a?+y(a,t):null,o=o?+y(o,t):null),s.push(a),s.push(o)}return s}function F({data:e,options:t}){const s=[];return t.mode===m&&e.selected.forEach(n=>{s.push(n?n.value:null)}),s}function Y(e,t,s){return!!t&&e<t||!!s&&e>s}function at(e,{type:t,mode:s}){const n=[];if(e){Array.isArray(e)||(e=[e]),s===_t&&e.length>1&&(e=e.slice(0,1)),s===m&&e.length>2&&(e=e.slice(0,2));const i=Tt[t];let a;e.forEach(o=>{a=D(o),a&&n.push({value:p(y(a,i)),date:a,fullText:y(a,"yyyy/MM/dd")})}),n.sort((o,r)=>o.value-r.value)}return n}function P(e,t,s){return t&&t>e||s&&s<e}function Dt(e,t,s,n){const i=[];switch(n){case m:{const[a,o]=e;a&&P(+a.date,t,s)&&i.push(a),o&&P(+o.date,t,s)&&i.push(o);break}default:e.forEach(a=>{P(+a.date,t,s)&&i.push(a)})}return i.length>0}function Rt(e){const{options:t}=this;let s=null;const[n,i]=g(t.dateRange);if(n&&+n>+s&&(s=n),i&&+i<+s&&(s=i),e.length)if(Dt(e,n,i,t.type)){let a=setTimeout(()=>{this.emit("error",new Error(`The default date[${t.defaultDate}] is not within the range[${t.dateRange}].`)),clearTimeout(a),a=null},0)}else s=e[0].date;return s}function j(e,{data:t,options:s}){return s.mode===m&&t.selected.length===1?e===t.selected[0].value:!1}function T(e){if(typeof e>"u"&&(e="undefined"),e===null&&(e="null"),R(e))return document.createTextNode(e);const t=document.createElement(e.t||"div"),s=e.a;s&&typeof s=="object"&&Object.keys(s).forEach(i=>{t.setAttribute(i,s[i])});const n=e.c;return Array.isArray(n)&&n.length>0&&n.forEach(i=>{t.appendChild(T(i))}),t}function B(e,t=document){if(!e)return null;let s=null;return R(e)?s=t.querySelector(e):typeof e=="object"&&e.nodeType===1&&(s=e),s}function bt(e,t,s){const n="__item",i={};if(t.includes(n))i.el=e,i.className=t;else if(e!==s){let a=e.parentElement;for(;a&&a!==s;){if(a.className.split(" ").includes(n)){i.el=a,i.className=a.className.split(" ");break}a=a.parentElement}}return i.el&&(i.index=p(i.el.getAttribute("data-index"))),i}function b(...e){const t=e[0],s=e.slice(1),n=[];t.className.split(" ").forEach(i=>{s.includes(i)||n.push(i)}),t.className=n.join(" ")}function I(...e){const t=e[0],s=t.className.split(" ");e.slice(1).forEach(n=>{s.includes(n)||s.push(n)}),t.className=s.join(" ")}const Ct={a:{class:"zx-calendar"}},Lt={a:{class:"zx-calendar-header-wrapper"},c:[{a:{class:"__l"},c:[{t:"button",a:{type:"button",class:O}},{t:"button",a:{type:"button",class:[O,C].join(" ")}}]},{a:{class:x}},{a:{class:"__r"},c:[{t:"button",a:{type:"button",class:[w,C].join(" ")}},{t:"button",a:{type:"button",class:w}}]}]},Nt={a:{class:"zx-calendar-week-wrapper"},c:[]},It={a:{class:"zx-calendar-body-wrapper"}},kt={a:{class:"zx-calender-footer-wrapper"},c:[]},Ot={confirm:{t:"button",a:{class:Z}},clear:{t:"button",a:{class:Q}},cancel:{t:"button",a:{class:tt}}};function wt(e,t){if(t.type!==$)return null;const s=JSON.parse(JSON.stringify(Nt));return e.forEach((n,i)=>{const a=i===0||i===6;s.c.push({a:{class:q+(a?" "+yt:"")},c:[n]})}),T(s)}function H(e,t,s,n){const i=e.some(o=>t&&o.value&&o.value<t),a=e.some(o=>s&&o.value&&o.value>s);i?I(n,K):b(n,K),a?I(n,X):b(n,X)}function W(e,t,{titleFormatter:s,type:n,itemSuffix:i,showHoliday:a},{header:o,body:r}){const u=t[e]||[];let d=null;if(n===L){const S=u[0],c=u[u.length-1];let E=0;d=s.replace(/(y+)/g,()=>E++===0?S.text:c.text)}else d=y(t.currentDate,s);B("."+x,o).innerText=d;let l,f,M;r.innerHTML=u.reduce((S,c,E)=>(l=["__item"],c.disabled&&l.push(V),c.value>0?(M="",c.holiday&&(l.push(ft),M=` title="${c.holiday}"`),c.selected&&l.push(_),c.current&&l.push(pt),c.isRangeFirst&&c.isRangeLast?l.push(z):(c.isRangeFirst&&l.push(G),c.isRangeLast&&l.push(U)),c.isRangeTemp&&l.push(J),f=[`<div class="${l.join(" ")}" data-index="${E}"${M}>`],f.push('<div class="__inner">'),f.push(`<p class="__text">${c.text}`),i&&f.push(`<span class="__suffix">${i}</span>`),a&&c.holiday&&f.push(`<span class="__holiday">${c.holiday}</span>`),f.push("</p></div></div>")):f=[`<div class="${l.join(" ")}"><div class="__inner"></div></div>`],S.push(f.join("")),S),[]).join("")}function ot(e,{body:t},s){const[...n]=t.querySelectorAll("."+_);n.forEach(i=>{b(i,_),s&&b(i,G,U,z)}),I(e,s?J:_)}const rt="single",xt="multiple",$t="range",lt="date",vt="month",Ft="year",Yt={date:"yyyy/MM/dd",month:"yyyy/MM",year:"yyyy"},ct={primary:"#f30",arrow:"#999",holidayDot:"rgba(0, 0, 0, 0.2)",currentItemBg:"#eee",white:"#fff",rangeBg:"#eee"},ut={el:null,dateRange:[],lang:"zh",showHoliday:!1,type:lt,isFullWeek:!1,titleFormatter:A,itemSuffix:null,defaultDate:[],itemFormatter:null,mode:rt,langPackage:null,footerButtons:["clear","cancel","confirm"],footerButtonAlign:"flex-end",hideFooter:!1,colors:{}},Pt="";function k(e={}){const t={...ut,...e,colors:{...ct,...e.colors}};if(e.titleFormatter||(t.type===L?t.titleFormatter=dt:t.type===v&&(t.titleFormatter=ht)),!t.el||!B(t.el))throw new Error(`Initial parameter el[${t.el}] is invalid.`);this.options=t,this._eventList={};const{langPackage:s}=mt(t);this.langPackage=s,this.$els={};const n=new Date,i=y(n,"yyyy/MM/dd",s);let a=[];try{a=at(t.defaultDate,t)}catch(u){setTimeout(()=>{this.emit("error",u)},0)}const o=Rt.call(this,a)||n,r=y(o,"yyyy/MM/dd");this.data={today:i,currentDate:o,currentDay:r,current:r.split("/"),selected:a,dates:[],months:[],years:[]},this._initDom()}k.prototype={constructor:k,formatDate(e,t,s){return s||(s=this.langPackage),y(e,t,s)},toDate(e){const t=D(e);return t||this.emit("error",new Error(`"${e}" is an invalid Date!`)),t},emit(...e){const t=e[0];this._eventList[t]&&this._eventList[t].forEach(s=>{s.apply(this,e.slice(1))})},on(e,t){!R(e)||!it(t)||(this._eventList[e]||(this._eventList[e]=[]),this._eventList[e].push(t))},off(e){!R(e)||!this._eventList[e]||(this._eventList[e].length=0)},_initDom(){const e=this.options,t=B(e.el),s=JSON.parse(JSON.stringify(Ct)),n=[s.a.class,"type-is-"+e.type,"mode-is-"+e.mode];s.a.class=n.join(" "),s.a.style=Object.keys(e.colors).map(u=>`--zx-calendar-color-${u}: ${e.colors[u]}`).join(";");const i=T(s),a=T(Lt);i.appendChild(a);const o=wt(this.langPackage.weeks,e);o&&i.appendChild(o);const r=T(It);if(i.appendChild(r),!e.hideFooter&&(e.mode===et||e.mode===m)){const u=JSON.parse(JSON.stringify(kt));e.footerButtons.forEach(l=>{u.c.push({...Ot[l],c:[this.langPackage[l+"Button"]]})});const d=T(u);e.footerButtonAlign&&(d.style.justifyContent=e.footerButtonAlign),i.appendChild(d)}t.appendChild(i),this.$els={calendar:i,header:a,week:o,body:r,parent:t},this._updateDom(),this.eventsHandler=this._eventsHandler.bind(this),this.$els.calendar.addEventListener("click",this.eventsHandler)},_eventsHandler(e){e.stopPropagation();const t=e.target,s=t.className.split(" "),n=t.innerText;if(s.includes(O))this.prev(!s.includes(C));else if(s.includes(w))this.next(!s.includes(C));else if(s.includes(Z))this.emit("change",[...this.data.selected]);else if(s.includes(tt))this.emit("cancel");else if(s.includes(Q))this.setDate();else if(s.includes(x))this._onTitleClick({innerText:n,el:t,className:s});else if(s.includes(q))this._onWeekClick({innerText:n,el:t,className:s});else{const i=bt(t,s,this.$els.calendar);i.el&&this._onItemClick(i)}},_onTitleClick(e){this.emit("onTitleClick",e)},prev(e){let[t,s]=this.data.current;switch(this.options.type){case $:if(e){t=p(t)-1;const[n]=g(this.options.dateRange,"yyyy");if(n&&t<=n){t=n;const[i]=g(this.options.dateRange,"MM");i&&(s=i)}}else s=p(s)-1,s===0&&(t=p(t)-1,s=12);this.setCurrentDate([t,s,"01"].join("/"));break;case v:this.setCurrentDate(t-1);break;case L:{const n=this.data.years[0]||{};this.setCurrentDate(n.value-1);break}}},next(e){let[t,s]=this.data.current;switch(this.options.type){case $:if(e){t=p(t)+1;const[,n]=g(this.options.dateRange,"yyyy");if(n&&t>=n){t=n;const[,i]=g(this.options.dateRange,"MM");i&&(s=i)}}else s=p(s)+1,s===13&&(t=p(t)+1,s=1);this.setCurrentDate([t,s,"01"].join("/"));break;case v:this.setCurrentDate(p(t)+1);break;case L:{const n=this.data.years,i=n[n.length-1]||{};this.setCurrentDate(i.value+1);break}}},_onWeekClick(e){this.emit("onWeekClick",e)},_onItemClick({el:e,className:t,index:s}){if(t.includes(V))return;const i=(this.data[this.options.type+"s"]||[])[s]||{};if(this.options.mode===m){const a=[...this.data.selected],o=a.length;o===0||o>=2&&a.every(r=>!!r)?(this.data.selected=[i],ot(e,this.$els,!0)):o===1&&(a[0].value<i.value?this.data.selected.push(i):this.data.selected.unshift(i),this._updateDom())}else if(this.options.mode===et)if(t.includes(_)){b(e,_);const a=this.data.selected.findIndex(o=>o.value===i.value);this.data.selected.splice(a,1)}else I(e,_),i.selected=!0,this.data.selected.push(i);else t.includes(_)||(ot(e,this.$els),i.selected=!0,this.data.selected=[{...i}],this.emit("change",[...this.data.selected]))},setDateRange(e,t){this.options.dateRange=[e,t],this._updateDom()},setDate(e){try{if(this.data.selected=at(e,this.options),this.data.selected.length===0){this._updateDom();return}const t=this.data.selected[0];this.setCurrentDate(t.fullText)}catch(t){this.emit("error",t)}},getDate(){return this.data.selected.slice(0)},setCurrentDate(e){const t=this.toDate(String(e));if(!t)return;const s=y(t,"yyyy/MM/dd");this.data.currentDate=t,this.data.currentDay=s,this.data.current=s.split("/"),this._updateDom()},_updateDom(){switch(this.options.type){case"date":this.createDays(),W("dates",this.data,this.options,this.$els);break;case"month":this.createMonths(),W("months",this.data,this.options,this.$els);break;case"year":this.createYears(),W("years",this.data,this.options,this.$els);break}},createYears(){const[e,t]=g(this.options.dateRange,"yyyy"),[s,n]=F(this),i=[],a=this.data.today.substr(0,4),{startFullYear:o,endFullYear:r}=At(this.data.current[0]);let u;for(let d=o;d<=r;d++)u=d.toString(),i.push({text:u,fullText:u,value:d,disabled:Y(d,e,t),isRangeFirst:d===s&&n,isRangeLast:d===n&&s,isRangeTemp:j(d,this),selected:this._isSelected(d),current:a===u,date:this.toDate(u)});this.data.years=i,H(i,e,t,this.$els.calendar)},createMonths(){const[e,t]=g(this.options.dateRange,"yyyyMM"),[s,n]=F(this),i=[],a=this.data.today.substr(0,7),o=this.data.current[0]+"/",r=p(this.data.current[0])*100;let u,d,l;for(let f=1;f<=12;f++)u=N(f),d=o+u,l=r+f,i.push({text:u,fullText:d,value:l,disabled:Y(l,e,t),isRangeFirst:l===s&&n,isRangeLast:l===n&&s,isRangeTemp:j(l,this),selected:this._isSelected(l),current:d.startsWith(a),date:this.toDate(d)});this.data.months=i,H(i,e,t,this.$els.calendar)},createDays(){const[e,t]=g(this.options.dateRange,"yyyyMMdd"),[s,n]=F(this),{firstDayOfWeek:i,lastDayOfMonth:a}=Mt(this.data),o=new Array(i).fill(0);for(let c=1;c<=a;c++)o.push(c);if(o.length%7!==0)for(let c=0;c<o.length%7;c++)o.push(0);let r=0,u,d,l;const f=this.data.current.slice(0,2).join("/")+"/",{itemFormatter:M}=this.options,S=o.map(c=>{r>6&&(r=0),u=c>0?N(c):"";const E=f+u;return l=c>0?+E.replace(/\//g,""):0,d={text:u,fullText:c>0?E:"",value:l,week:r++,disabled:!c||Y(l,e,t),holiday:!1,isRangeFirst:l===s&&n,isRangeLast:l===n&&s,isRangeTemp:j(l,this),selected:this._isSelected(l),current:this.data.today===E,date:c>0?this.toDate(E):null},it(M)?M(d):d});this.data.dates=S,H(S,e,t,this.$els.calendar)},destroy(){this.$els.calendar.removeEventListener("click",this.eventsHandler),this.$els.parent.removeChild(this.$els.calendar)},_isSelected(e){const t=this.data.selected;switch(this.options.mode){case m:{const[s,n]=t;if(e&&s&&n)return e>=s.value&&e<=n.value;break}default:return t.some(s=>s.value===e)}return!1}},h.DEF_COLORS=ct,h.DEF_OPTIONS=ut,h.FORMATTERS=Yt,h.MODE_MULTIPLE=xt,h.MODE_RANGE=$t,h.MODE_SINGLE=rt,h.TYPE_DATE=lt,h.TYPE_MONTH=vt,h.TYPE_YEAR=Ft,h.ZxCalendar=k,h.default=k,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
